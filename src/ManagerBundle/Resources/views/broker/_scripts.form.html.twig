<script>
    $(document).ready(function () {
        var $markets = $('#managerbundle_broker_markets');

        $markets.select2();

        var $type = $('#managerbundle_broker_type');

        if (!$type.val()) {
            $markets.prop('required', false);
            $markets.parent().parent().hide();
        }

        // When region gets selected ...
        $type.change(function() {
            if (this.value == 'stocks') {
                $markets.prop('required', true);
                $markets.parent().parent().show();
            } else {
                // unselect all
                $markets.val('').trigger("change");

                $markets.prop('required', false);
                $markets.parent().parent().hide();
            }
        });
    });
</script>